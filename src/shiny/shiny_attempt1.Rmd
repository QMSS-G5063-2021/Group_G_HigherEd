---
title: "shiny_attempt1"
author: "Arielle Herman"
date: "4/18/2021"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(ggridges)
library(leaflet)

source("app.R")
```


```{r}
ui <- dashboardPage(
  dashboardHeader(title = "Group G: Student Debt"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("About", tabName = "about"),
      menuItem("Student Loans", tabName = "loans"),
      menuItem("What do people think?", tabName = "tweets")
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "about", class = "active",
              fluidPage(
                tags$div(
                  tags$h1("Project Motivation"),
                  "Biden's recent loan forgiveness bill has sparked much debate.  And so, we decided to investigate
                  student repayment rates and student debt over time.  Then, we look at what people are saying and where
                  they are saying it.",
                  tags$h1("Sources"),
                  "For our project, we looked at data from the following sources:
                  (1) Scorecard, (2) Urban Institute Education Data, (3) Twitter API, and (4) Google Trends",
                  tags$h1("Team Members"),
                  "Arielle Herman, Connie Xu, Grace Li, Ariel Luo"
                )
              )),
      tabItem(tabName = "loans", class = "active",
        fluidPage(
          tags$div(
            tags$h1("Repayment Rates")),
          fluidRow(align = "left",
                   column(7, plotOutput("repay_rate_ave")),
                   column(3, p("This first figure demonstrates the proportion of students across all University
                               fiscal cohorts who successfully make progress on repaying their loans in their
                               first year of repayment.  It highlights a declining average trend across all three income
                               brackets: smaller proportions of successive fiscal cohorts decline their loan
                               balances over time.  While the average fiscal cohort may be having more difficulty in
                               repaying their loans, we can look to the distribution of repayment rates across
                               universities in order to determine whether or not income brackets have been impacted
                               differently over time.")),
                   br())),
          fluidRow(align = "left",
                   column(3, p("This density plot demonstrates the distribution of repayment proportions across
                   universities for the first year of repayment for recent fiscal cohorts.  Each unviersity's fiscal 
                   cohort is then further subdivided by income bracket (such that there can be as many as three 
                   datapoints per university).  This reaffirms the findings in the previous plot, but also indicates
                   that the lowest income bracket has experienced the largest decrease in proportions of students who
                   make progress on their loans.")),
                   column(7, plotOutput("repay_rate_dist"))),
          tags$div(
            tags$h1("Student Debt")
          )
        ),
      tabItem(tabName = "tweets", class = "active",
          fluidPage(
            fluidRow(align = "left",
                    column(5, plotOutput("trend")),
                    column(5, plotOutput("wordcloud"))),
            fluidRow(align = "left",
                     column(5, p("The google trend website gives us data about the time period and the count of total number of searches on Google. Plotting the total number of searches overtime helps us to see changes in people's interest in student loan forgiveness. The pattern clearly shows that people's interest in this topic has spiked in 2021. We hypothesized that this is a result of the Biden administration's recent announcement of a reinterpretation of a federal student loan cancellation program which will result in $1 billion in student loan forgiveness. Ever since this announcement, more people have been pushing for a more progressive policy and asking President Biden to cancel student debt through executive action. There is still a lot of uncertainties around whether a universal student loan forgiveness will be initiated via an executive order or via legislation." )),
            column(5, p("The wordcloud map shows key words that appeared in the tweets data. The size of the word represents how frequently it appears in tweets. Some of the most noticeable ones include people, president, loans, job, college, pay, biden, education, studentloanforgiveness, etc. This keywords pattern confirms our initial hypothesis that the recent discussion on canceling student debt on twitter is around the biden administration as a result of the $1B student loan cancellation announced in Mid-march. " ))),
            fluidRow(column(10, leafletOutput("tweetsmap")))),
            fluidRow(align = "left",
                     column(10, p("Lastly, we want to see if there's an overlap between the states that are most concerned about student loan forgiveness and where the selective schools are located. We added two layers on the map to showcase patterns. The first layer tells us which states are most concerned about student loan forgiveness by setting the radius of the circle to the total tweets word count. The gradient color scale shows the sentiment score of each state where red means a more negative average tweets sentiment and green means a more positive tweet sentiment on average. In addition, the popup window shows the top tweets keywords in each state after getting ride of most frequent keywords such as student, loan, debt, cancelstudentdebt, and amp. In California, not only do people tweet the most about student loan forgiveness, but they also have a more positive sentiment toward student loan forgiveness. Other areas where there are more discussions on student loan forgiveness concentrate along the coastal states. Midwestern states are least concerned about student loan forgiveness, and their tweets sentiment is also more negative. 
   
   The second layer shows where the selective institutions are located, where purple icon stands for elite universities, green icon stands for highly selective universities, and blue icon stands for selective universities. Overall, these selective universities are concentrated along the coastlines. On the west coast, most of the selective universities are in California. And the selective universities spread out more evenly on the east coast. Overall, we can see an overlap by looking at the two layers together. States with higher concentration of selective schools are also where people are most concerned about student loan forgiveness " )))),
      )
    )
  )
)

server <- function(input, output) {
  #library(tidyverse)
  # arielle ~~~~~~~~~~~~~~~~~~~~~
  output$repay_rate_ave <- renderPlot({
    repay_rate_ave
    
  })
  output$repay_rate_dist <- renderPlot({
    repay_rate_dist
    })
  # grace ~~~~~~~~~~~~~~~~~~~~~~~
  
  output$trend <- renderPlot({
    Trend
  })
  
  output$wordcloud <- renderPlot({
    Twitter_wd
  })
  
  output$tweetsmap <- renderLeaflet({
    TweetsMap
  })
  
}

shinyApp(server = server, ui = ui)

```