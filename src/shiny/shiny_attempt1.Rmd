---
title: "shiny_attempt1"
author: "Arielle Herman"
date: "4/18/2021"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(ggridges)
library(leaflet)

source("app.R")
```


```{r}
ui <- dashboardPage(
  dashboardHeader(title = "Group G: Student Debt"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("About", tabName = "about"),
      menuItem("Student Loans", tabName = "loans"),
      menuItem("What do people think?", tabName = "tweets")
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "about", class = "active",
              fluidPage(
                tags$div(
                  tags$h1("Project Motivation"),
                  "Biden's recent loan forgiveness bill has sparked much debate.  And so, we decided to investigate
                  student repayment rates and student debt over time.  Then, we look at what people are saying and where
                  they are saying it.",
                  tags$h1("Sources"),
                  "For our project, we looked at data from the following sources:
                  (1) Scorecard, (2) Urban Institute Education Data, (3) Twitter API, and (4) Google Trends",
                  tags$h1("Team Members"),
                  "Here, we can list a little infor about ourselves",
                  tags$h3("Arielle Herman"), "Arielle's email address",
                  tags$h3("Connie Xu"), "Connie's awesome...",
                  tags$h3("Grace Li"), "Grace is awesome...",
                  tags$h3("Ariel Luo"), "Ariel is awesome..."
                )
              )),
      tabItem(tabName = "loans", class = "active",
        fluidPage(
          tags$div(
            tags$h1("Repayment Rates")),
          fluidRow(align = "left",
                   column(7, plotOutput("repay_rate_ave")),
                   column(3, p("This first figure demonstrates the proportion of students across all University
                               fiscal cohorts who successfully make progress on repaying their loans in their
                               first year of repayment.  It highlights a declining average trend across all three income
                               brackets: smaller proportions of successive fiscal cohorts decline their loan
                               balances over time.  While the average fiscal cohort may be having more difficulty in
                               repaying their loans, we can look to the distribution of repayment rates across
                               universities in order to determine whether or not income brackets have been impacted
                               differently over time.")),
                   br())),
          fluidRow(align = "left",
                   column(3, p("This density plot demonstrates the distribution of repayment proportions across
                   universities for the first year of repayment for recent fiscal cohorts.  Each unviersity's fiscal 
                   cohort is then further subdivided by income bracket (such that there can be as many as three 
                   datapoints per university).  This reaffirms the findings in the previous plot, but also indicates
                   that the lowest income bracket has experienced the largest decrease in proportions of students who
                   make progress on their loans.")),
                   column(7, plotOutput("repay_rate_dist"))),
          tags$div(
            tags$h1("Student Debt")
          )
        ),
      #),
      tabItem(tabName = "tweets", class = "active",
          fluidPage(
            fluidRow(align = "left",
                    column(5, plotOutput("trend")),
                    column(5, plotOutput("wordcloud"))),
            fluidRow(align = "left",
                     column(10, p("Grace add description here. And here."))),
            fluidRow(
              column(10, leafletOutput("tweetsmap"))))
      )
    )
  )
)

server <- function(input, output) {
  #library(tidyverse)
  # arielle ~~~~~~~~~~~~~~~~~~~~~
  output$repay_rate_ave <- renderPlot({
    repay_rate_ave
    
  })
  output$repay_rate_dist <- renderPlot({
    repay_rate_dist
    })
  # grace ~~~~~~~~~~~~~~~~~~~~~~~
  
  output$trend <- renderPlot({
    Trend
  })
  
  output$wordcloud <- renderPlot({
    Twitter_wd
  })
  
  output$tweetsmap <- renderLeaflet({
    TweetsMap
  })
  
}

shinyApp(server = server, ui = ui)

```